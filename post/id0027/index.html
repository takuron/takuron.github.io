<!doctype html><html lang=zh-CN dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="本文记录了OPNsense系统的详细安装与基本配置过程，包括硬件选择、系统安装步骤、多LAN口桥接设置、基础防火墙规则配置、WAN口PPPoE拨号、IPv6初步启用（SLAAC）、DHCPv4设置以及系统更新和配置备份，为新用户提供了实操指南。"><title>OPNsense使用记录01：安装与基本配置</title><link rel=canonical href=https://takuron.com/post/id0027/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="OPNsense使用记录01：安装与基本配置"><meta property='og:description' content="本文记录了OPNsense系统的详细安装与基本配置过程，包括硬件选择、系统安装步骤、多LAN口桥接设置、基础防火墙规则配置、WAN口PPPoE拨号、IPv6初步启用（SLAAC）、DHCPv4设置以及系统更新和配置备份，为新用户提供了实操指南。"><meta property='og:url' content='https://takuron.com/post/id0027/'><meta property='og:site_name' content='Takuron'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='网络'><meta property='article:tag' content='路由器'><meta property='article:tag' content='组网'><meta property='article:tag' content='opnsense'><meta property='article:published_time' content='2024-11-16T00:00:00+00:00'><meta property='article:modified_time' content='2024-11-16T00:00:00+00:00'><meta property='og:image' content='https://img.takuron.com/blogpost/KABjvaXbhSmWkCg.webp'><meta name=twitter:title content="OPNsense使用记录01：安装与基本配置"><meta name=twitter:description content="本文记录了OPNsense系统的详细安装与基本配置过程，包括硬件选择、系统安装步骤、多LAN口桥接设置、基础防火墙规则配置、WAN口PPPoE拨号、IPv6初步启用（SLAAC）、DHCPv4设置以及系统更新和配置备份，为新用户提供了实操指南。"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://img.takuron.com/blogpost/KABjvaXbhSmWkCg.webp'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_99cd85e0adff5c09.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Takuron</a></h1><h2 class=site-description>间歇性踌躇满志，持续性混吃等死。</h2></div></header><ol class=menu-social><li><a href=https://space.bilibili.com/11680006 target=_blank title=Bilibili rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 014-4h10a4 4 0 014 4v6a4 4 0 01-4 4H7a4 4 0 01-4-4v-6z"/><path d="M8 3l2 3"/><path d="M16 3l-2 3"/><path d="M9 13v-2"/><path d="M15 11v2"/></svg></a></li><li><a href=mailto:recevier0612@takuron.com target=_blank title=Email rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://github.com/takuron target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://wxw.moe/@takuron target=_blank title=Mastodon rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-mastodon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.648 15.254C16.832 17.017 12 16.88 12 16.88a18.262 18.262.0 01-3.288-.256c1.127 1.985 4.12 2.81 8.982 2.475-1.945 2.013-13.598 5.257-13.668-7.636L4 10.309c0-3.036.023-4.115 1.352-5.633C7.023 2.766 12 3.01 12 3.01s4.977-.243 6.648 1.667C19.977 6.195 20 7.274 20 10.31s-.456 4.074-1.352 4.944z"/><path d="M12 11.204V8.278C12 7.02 11.105 6 10 6S8 7.02 8 8.278V13m4-4.722C12 7.02 12.895 6 14 6s2 1.02 2 2.278V13"/></svg></a></li><li><a href=/index.xml target=_blank title=Rss rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-rss"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=https://www.travellings.cn/go.html target=_blank><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-train"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 13c0-3.87-3.37-7-10-7H3"/><path d="M3 15h16a2 2 0 002-2"/><path d="M3 6v5h17.5"/><path d="M3 11v4"/><path d="M8 11V6"/><path d="M13 11V6.5"/><path d="M3 19h18"/></svg>
<span>Travelling</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#前置条件>前置条件</a></li><li><a href=#系统安装>系统安装</a></li><li><a href=#基本配置>基本配置</a><ol><li><a href=#初始化>初始化</a></li><li><a href=#启用所有lan口>启用所有LAN口</a></li><li><a href=#防火墙初步>防火墙初步</a></li><li><a href=#拨号dhcp和ipv6初步>拨号、DHCP和IPV6初步</a></li><li><a href=#更新-备份-杂项>更新 备份 杂项</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/id0027/><img src=https://img.takuron.com/blogpost/KABjvaXbhSmWkCg.webp loading=lazy alt="Featured image of post OPNsense使用记录01：安装与基本配置"></a></div><div class=article-details><header class=article-category><a href=/categories/opnsense/ style=background-color:orange;color:#fff>OPNsense</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/id0027/>OPNsense使用记录01：安装与基本配置</a></h2><h3 class=article-subtitle>本文记录了OPNsense系统的详细安装与基本配置过程，包括硬件选择、系统安装步骤、多LAN口桥接设置、基础防火墙规则配置、WAN口PPPoE拨号、IPv6初步启用（SLAAC）、DHCPv4设置以及系统更新和配置备份，为新用户提供了实操指南。</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 16, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 6 分钟</time></div></footer></div></header><section class=article-content><p>自从去年受够openwrt各种插件之间的兼容性问题和遭遇了n5105小包总线速度问题导致的系统崩溃之后转向了OPNsense系统。作为一个专业的开源防火墙，其中文资料却少得可怜，去年第一次装的时候就准备全程记录一下配置的过程，一直因为时间问题没能实现。到了现在软路由硬件都换了一遍，结果再装还是资料少的可怜频频踩坑，故开坑记录一下，免得我自己也天天往一个坑里跳。</p><h2 id=前置条件>前置条件</h2><p>能选择这个系统的应该对软路由硬件挑选已经有自己的见解了吧，OPNsense 是基于 FreeBSD 的开源防火墙系统，理论上有驱动的硬件你随便选就可以。这里本人使用的是畅网n100的四网畅想版ddr4的版本来安装，并不是什么高性价比的东西单纯偷懒。内存为8g，硬盘则是用了一个傲腾16g，反正不记录log只装系统我就没见过用爆的，本身量大寿命又长，除了强制要有m.2口外其实很适合做这种工控机的系统盘。</p><p><img src=https://img.takuron.com/blogpost/c21f75db8a7c889eb7edd5d7153b4076_MD5.jpg loading=lazy alt=使用的软路由></p><p><a class=link href=https://opnsense.org/users/get-started/ target=_blank rel=noopener>这里</a>可以查到官方的硬件要求。</p><p><a class=link href=https://opnsense.org/download/ target=_blank rel=noopener>你可以在这里下载到OPNsense</a>，下载类型选择amd64和dvd，镜像国内选北京大学的即可。下载好后可以直接用<a class=link href=https://rufus.ie/zh/ target=_blank rel=noopener>rufus</a>写入u盘安装。</p><p><img src=https://img.takuron.com/blogpost/8740cfde28346a5169dd64f27ebc19a2_MD5.webp loading=lazy alt=下载界面></p><h2 id=系统安装>系统安装</h2><blockquote><p>因本人没有采集卡并且不喜欢拍屏，故本节非web界面的截图均来自<a class=link href=https://www.bilibili.com/opus/784755568172597299 target=_blank rel=noopener>b站@狐狸Nomad</a>，顺便感谢大佬的指南。</p></blockquote><p>从u盘启动，一直跑马直到出现“Press any key to start the configuration importer: &mldr;”。不用管。</p><p><img src=https://img.takuron.com/blogpost/1dc4311bc45ff5d9b0ddc1b8eff798cd_MD5.webp loading=lazy alt=mflzo9aaoffx550e.webp></p><p>等到跑马出现“Press any key to start the manual interface assignment”的时候，你可以点击任何键来配置接口，在这里你可以手动配置一下wan口和lan口。但由于OPNsense的逻辑和openwrt不太一样这里的lan口只能配置一个，我倾向于直接跳过回头webui里面配置。如果你需要改可以按提示设置一下lan和wan对应的网口，其他选项除了最后保存全都直接回车跳过即可。</p><p><img src=https://img.takuron.com/blogpost/1e1237e11b361bbc142a62b1dd0e6cba_MD5.webp loading=lazy alt=yioc701c2ndx4hpy.webp></p><p><img src=https://img.takuron.com/blogpost/a5db774b7d7b679562356823bb91c7a9_MD5.webp loading=lazy alt=x3xnsvza5ao3sy2d.webp></p><p>然后就提示登录了，这里我们可以看到OPNsense为我们启动了一个体验版的系统，你可以连接lan口来体验。这里我们登录安装账号来开始安装到本地，在24.7版本安装账号名为installer,密码opnsense。</p><p><img src=https://img.takuron.com/blogpost/f67c13dafeda013572f169984c98b40a_MD5.webp loading=lazy alt=t50aqha0g8eufwp4.webp></p><p>登录后就进入了安装界面，选择默认键盘布局。</p><p><img src=https://img.takuron.com/blogpost/0e5670f94184b7b4dcc7e416c2055485_MD5.webp loading=lazy alt=cuxvjptvwch2gfi9.webp></p><p>选择安装的硬盘分区格式，现在默认就是ZFS选择就可以了。</p><p><img src=https://img.takuron.com/blogpost/2a74538c3f6feeca085c2ecbdb22c6a8_MD5.webp loading=lazy alt=067n3phbpqsa7inw.webp></p><p>选择冗余模式，你可以在这里给系统做软raid，这里一块盘选stripe。</p><p><img src=https://img.takuron.com/blogpost/d0fc28cdd5dedeca3dcb9501097c15ba_MD5.webp loading=lazy alt=8656mlvm1u46q747.webp></p><p>选择安装的硬盘</p><p><img src=https://img.takuron.com/blogpost/f312610652aa997367a9c533846c3b8d_MD5.webp loading=lazy alt=qaglrtzszpnerk7e.webp></p><p>然后就开始安装了，安装结束后会显示这个界面，建议在这里修改一下root用户的密码，回头你需要用这个密码登录管理界面。</p><p><img src=https://img.takuron.com/blogpost/0f27a163930951037627aa6ecfbea2c2_MD5.webp loading=lazy alt=zeo9w02o5pd2nhx8.webp></p><p>重启，然后等待到提示登录时按照显示的lan口和网关地址打开浏览器就可以看到登录界面了（ssl证书错误请直接了解详细，仍要访问即可）。登录用户名为root，密码为你上一步设置的密码。</p><p><img src=https://img.takuron.com/blogpost/51cb0c478fe5cdfd4d34e954fd43afa2_MD5.webp loading=lazy alt=Snipaste_2024-11-16_19-34-41-tuya.webp></p><p><img src=https://img.takuron.com/blogpost/0b0b0fe4cf7666b7420731f657f053f8_MD5.webp loading=lazy alt=Snipaste_2024-11-16_12-28-43-tuya.webp></p><p>然后就可以接上wan口开始配置了。</p><h2 id=基本配置>基本配置</h2><h3 id=初始化>初始化</h3><p>初始化其实按照引导一步步设置即可，首先设置时间和时区，这里可以改成阿里的btp服务器也可以不动。</p><p><img src=https://img.takuron.com/blogpost/21128a7926b2f82975a847508679f15a_MD5.webp loading=lazy alt=Snipaste_2024-11-16_11-12-26-tuya.webp></p><p>设置主机名、dns和语言，这些我们都不用动后面会用AdGuardHome。</p><p><img src=https://img.takuron.com/blogpost/5e0c77fd646a605431a855c291d54001_MD5.webp loading=lazy alt=PixPin_2024-01-17_14-33-06-tuya.webp></p><p>这里有一个图少截了，会问你WAN口的类型，我这里还没插网线直接选的pppoe但没给账号密码，如果上一步你接上了网线可以这会儿就配置了。</p><p>设置LAN ip和网段，选一个自己喜欢的局域网网段即可。这里我写错了网关地址应为172.24.0.1。</p><p><img src=https://img.takuron.com/blogpost/330c383ca5dda4ee18785f5cda0cc7b1_MD5.webp loading=lazy alt=Snipaste_2024-11-16_11-16-28-tuya.webp></p><p>然后机器就会重启，初始化就基本完成了。</p><h3 id=启用所有lan口>启用所有LAN口</h3><p>pfsense和OPNsense的第一个坑就是他们的接口（interface）都只能实际绑定一个物理网口，<strong>如果需要给几个网口做默认桥接就要每个网口单独设置一个没有网络的接口，然后用网桥连接这些接口后绑定在LAN上</strong>。这和openwrt的习惯是不一样的。</p><p>我们现在就来把我这个机器的igc1/2/3设置成互相桥接的LAN口，目前我已经给igc1在安装的时候设置成了机器的LAN，所以我们献给igc2/3建立一个网桥。先建立两个接口，分别绑定物理的网口2/3并启用，不需要任何ip设置。</p><p><img src=https://img.takuron.com/blogpost/a7d42adde49f3a294669d05a49a8f70b_MD5.webp loading=lazy alt=Snipaste_2024-11-16_22-53-51-tuya.webp></p><p>然后我们建立网桥，在接口/其他类型/网桥里面点一下加号，将刚才新建的两个接口加进去。</p><p><img src=https://img.takuron.com/blogpost/c131e544a7931d820c84d5fcfe5be1a8_MD5.webp loading=lazy alt=Snipaste_2024-11-16_12-48-16-tuya.webp></p><p>进入我们原先的LAN接口，把LAN接口改成我们新建立的网桥，保存。（注意所有的接口配置都需要二次选择应用才能生效）</p><p><img src=https://img.takuron.com/blogpost/66c8be4cb4e541ecaa10ec601ee49096_MD5.webp loading=lazy alt=PixPin_2024-01-17_14-59-40-tuya.webp></p><p>接入网口2/3，再将已经释放的igc1同样的创建接口并加入网桥即可。</p><h3 id=防火墙初步>防火墙初步</h3><p>以上述方法设置的LAN口虽然都可以正常访问网络，而且我们实际做局域网DHCP和NAT的“LAN”接口的规则是进出全部放行，但由于我们引入了新的接口，而这些接口的默认规则是放行出口禁止进口，这样会导致局域网下设备无法互相访问。</p><p>我们点开防火墙/规则，随便选择一个lan口，加号新建规则，这里我用最简单的方法先放行了所有LAN网络下的主机的入站，这样可以把最需要解决的局域网互相访问先处理好，后续感觉应该修改掉LAN口的全放行来控制流量更符合家用的环境。记得保存完规则后刷新让防火墙生效。</p><p><img src=https://img.takuron.com/blogpost/b81ec8db34ddeca073bfe44daf17982a_MD5.webp loading=lazy alt=Snipaste_2024-11-16_23-14-52-tuya.webp></p><p><img src=https://img.takuron.com/blogpost/8e4ae6553781884d3aa4626ee76e729f_MD5.webp loading=lazy alt=Snipaste_2024-11-16_23-14-15-tuya.webp></p><h3 id=拨号dhcp和ipv6初步>拨号、DHCP和IPV6初步</h3><p>我们转回到接口WAN，这里以山东联通普通家用有v6的环境为例进行拨号和通过上级路由分配ipv6地址。PPPoe设置非常的简单，只需要在这里写你宽带的用户名和密码就行。</p><p><img src=https://img.takuron.com/blogpost/7facc6352b72650b063057f89328e3f0_MD5.webp loading=lazy alt=Snipaste_2024-11-16_12-51-39-tuya.webp></p><p>然后是ipv6，拖到最底下可以看到DHCPv6客户端的设置，这里比较重要的是使用ipv4连接和仅请求地址前缀（request prefix only）必须打开。前缀委派大小和发送前缀大小这俩开与不开意义不大反正会被运营商美美无视。</p><p><img src=https://img.takuron.com/blogpost/f352587efe0b3c1cb5da5ec5e318e102_MD5.webp loading=lazy alt=Snipaste_2024-11-16_23-30-33-tuya.webp></p><p>在LAN口中打开允许手动调整DHCPv6和路由器通告。</p><p><img src=https://img.takuron.com/blogpost/67791bec3fe8d89626e65efa68d9fe15_MD5.webp loading=lazy alt=Snipaste_2024-11-16_23-31-12-tuya.webp></p><p>此时打开服务/DHCPv6，如果宽带能正常获取ipv6前缀应该可以看到分配的网段，长度从56bits到64bits不等，说明获取ipv6前缀成功。（不过先不要用DHCPv6，我们现在先用SLAAC分配v6更加方便快捷）</p><p><img src=https://img.takuron.com/blogpost/be8903fdb8005a8b176f7c49e718fa69_MD5.webp loading=lazy alt=Snipaste_2024-11-16_23-32-07-tuya.webp></p><p>我们打开服务/路由器通告，将通告模式设置成unmanaged仅使用SLAAC分配ipv6，这样最基本的拥有ipv6地址就做到了，后面我们会更详细的设置DHCPv6。</p><p><img src=https://img.takuron.com/blogpost/f1fdca300c3a66ae83b2d7fab69fa366_MD5.webp loading=lazy alt=Snipaste_2024-11-16_14-35-55-tuya.webp></p><p>同一级菜单下还可以改变DHCPv4的设定，最需要设置的可能是类似我这种给了更大的局域网网段，这种情况下DHCP可选的ip范围还是不够使用的话可以手动选择范围。</p><h3 id=更新-备份-杂项>更新 备份 杂项</h3><p>转到系统/固件/设置，这里可以先把更新源改成国内的，然后保存返回状态进行更新。</p><p><img src=https://img.takuron.com/blogpost/a5a64112c5d9677765454c65387d54eb_MD5.webp loading=lazy alt=Snipaste_2024-11-16_15-20-12-tuya.webp></p><p>系统/设置/其他里面可以修改主页温度传感器的温度源，志强用户还可以开启硬件加速。</p><p><img src=https://img.takuron.com/blogpost/84e3e43369b75c64f691048c3f74bfb1_MD5.webp loading=lazy alt=Snipaste_2024-11-16_15-07-26-tuya.webp></p><p>系统/设置/任务里面可以为系统设置定时任务，这里我让他每周重启。</p><p><img src=https://img.takuron.com/blogpost/ea7cd109058e57b448196a3e706d63f2_MD5.webp loading=lazy alt=Snipaste_2024-11-17_09-43-23-tuya.webp></p><p>最后我们可以吧已经配置好的配置文件下载下来，这样出现问题直接上传配置文件即可恢复全部设置了。</p><p><img src=https://img.takuron.com/blogpost/331e29fbc363c4c110787d2bb93d0c8c_MD5.webp loading=lazy alt=Snipaste_2024-11-17_09-40-51-tuya.webp></p><p>结束</p><blockquote><p>最后吐槽一下国内折腾软路由的，表面说支持开源和稳定，实际用着各种高大全魔改TUN的固件，为了开个魔法上网拒绝一切技术进步，ipv6这些和全局魔法冲突的统统全杀了还是避免不了不同模块打架出奇葩问题。你要和他说起稳定转头就投了有黑历史的闭源ikuai，就这样还热衷于all in boom建议两个全都真是系统简洁明了稳定。</p><p>我个人不喜欢纯粹的全局代理，因为没有一个固定的规则让我满意能完成我的一切需求，毕竟人的需求也是会根据实际情况变动的。个人还是更喜欢细化的给每个需要分流的软件单独设置代理，浏览器直接用两个，这种手动分类才是效率最高的。</p></blockquote></section><footer class=article-footer><section class=article-tags><a href=/tags/%E7%BD%91%E7%BB%9C/>网络</a>
<a href=/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/>路由器</a>
<a href=/tags/%E7%BB%84%E7%BD%91/>组网</a>
<a href=/tags/opnsense/>Opnsense</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>最后更新于 Nov 16, 2024 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/id0029/><div class=article-image><img src=https://img.takuron.com/blogpost/KABjvaXbhSmWkCg.webp loading=lazy data-key=id0029 data-hash=https://img.takuron.com/blogpost/KABjvaXbhSmWkCg.webp></div><div class=article-details><h2 class=article-title>OPNsense使用记录03：IPv6网络配置</h2></div></a></article><article class=has-image><a href=/post/id0028/><div class=article-image><img src=https://img.takuron.com/blogpost/KABjvaXbhSmWkCg.webp loading=lazy data-key=id0028 data-hash=https://img.takuron.com/blogpost/KABjvaXbhSmWkCg.webp></div><div class=article-details><h2 class=article-title>OPNsense使用记录02：第三方软件源和AdGuardHome配置</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=takuron/takuron.github.io data-repo-id=R_kgDOOgEzQw data-category=Announcements data-category-id=DIC_kwDOOgEzQ84CphSH data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2017 -
2025 Takuron</section><section class=powerby><a href=https://www.travellings.cn/go.html target=_blank rel=noopener title=开往-友链接力><img src=https://www.travellings.cn/assets/logo.gif alt=开往-友链接力 width=120></a><br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>